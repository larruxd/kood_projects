# MALWARE

### ⚠️ Warning ⚠️<br> This program is designed for educational purposes only. It emulates the behavior of ransomware, which can encrypt and potentially destroy data. Running this program on your machine can result in data loss. Use it only in a controlled, isolated environment such as a virtual machine. The author is not responsible for any damage caused by misuse of this software.

- ### [Video▶️](https://youtu.be/WYVk_j6xK5w)
- ### [Subject](https://github.com/01-edu/public/tree/master/subjects/cybersecurity/malware)
- ### [Audit](https://github.com/01-edu/public/tree/master/subjects/cybersecurity/malware/audit)

## Description

The purpose of this project was to closely emulate the functionality of WannaCry, a well-known ransomware program. The objective was to understand and replicate its behavior, including its encryption and decryption processes, as well as its ability to bypass anti-virus software.

## Requirements

- Windows-based virtual machine
- [Go](https://go.dev/doc/install)

## Usage

- Build the malware executable:

```sh
.\build.bat
```

- Place the executable in a folder (It will encrypt the contents of that folder recursively)
- Execute to encrypt
- Execute again to decrypt (key can be found on desktop inside README.txt file)

## Answers for audit questions

- ### Is the student able to explain clearly what ransomware means?

  Ransomware is a type of malware attack in which the attacker locks and encrypts the victim's data, important files and then demands a payment to unlock and decrypt the data.

- ### Is the student able to explain clearly how he can bypass the Anti-Viruses?

  What I learned from this project is that the more you try to avoid antivirus detection, the more likely your program will get flagged as suspicious or harmful. I tried all sorts of things, like running code from memory so it doesn't write to disk, and using Garble to obfuscate the code, but antivirus software is already familiar with most of these tricks and can detect them easily. Even if the program isn’t doing anything harmful, just trying to evade antivirus can get it flagged. In the end, I kept it simple by encoding the ransom note and avoiding words in strings that might look suspicious to antivirus programs.

- ### Is the student able to explain clearly how his ransomware works?

  The encryption part of the program starts by generating a random AES encryption key. It scans the current directory for files, excluding the program’s own executable.

  Each file is encrypted using AES-GCM, with a unique nonce generated for every file. The program checks for an "ENCRYPTED" marker at the start of each file to avoid encrypting the same file more than once. If the marker is not found, the file is encrypted, and the result is written back, replacing the original content.

  After encrypting, the program saves the list of encrypted file paths in a temporary file and generates a ransom note on the user's desktop, which includes the encoded decryption key. This key will be required to decrypt the files later.

- ### Is the student able to explain clearly how his decrypting program works?

  The decryption part of the program begins by asking the user to input the decryption key. The key is then decoded and used to reverse the encryption process.

  The program retrieves the list of encrypted file paths stored in a temporary file. It reads each file, checks for the "ENCRYPTED" marker, and removes it before proceeding. The AES-GCM decryption process is applied using the provided key and the nonce stored within each encrypted file.

  If the decryption is successful, the program writes the original, decrypted content back to the file, restoring it to its original state. Once all files are decrypted, the program deletes the temporary file containing the paths and the ransom note from the user's desktop.

## Author

### [laurilaretei](https://01.kood.tech/git/laurilaretei)

<hr>

#### ⚠️ These methods and tools are for educational purposes only, so that you have a better understanding of how to protect against similar vulnerabilities. You must ensure that you do not attempt any exploit-type activity without the explicit permission of the owner of the machine, system or application. Failure to obtain permission risks breaking the law.
